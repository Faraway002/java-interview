# Kafka 简介

## 1. 概述

Kafka 是一个分布式的基于发布\订阅的消息系统，有着强大的消息处理能力，相比与其他消息系统，具有以下特性：

- **快速数据持久化**，实现了 $O(1)$ 时间复杂度的数据持久化能力。
- **高吞吐**，能在普通的服务器上达到 10W 每秒的吞吐速率。
- **高可靠**，消息持久化以及副本系统的机制保证了消息的可靠性，消息可以多次消费。
- **高扩展**，与其他分布式系统一样，所有组件均支持分布式、自动实现负载均衡，可以快速便捷的扩容系统。
- **离线与实时处理能力并存**，提供了在线与离线的消息处理能力。

正是因其具有这些的优秀特性而广泛用于应用解耦、流量削峰、异步消息等场景，比如消息中间件、日志聚合、流处理等等。

## 2. Kafka 内的重要概念介绍

![image-20220628184119671](https://fastly.jsdelivr.net/gh/Faraway002/typora/images/image-20220628184119671.png)

### 2.1 Broker

一个独立的 Kafka 实例，多个 Kafka Broker 组成一个 Kafka Cluster（集群）。

### 2.2 Topic

每条发布到 Kafka 的消息都有一个类别，这个类别被称为 Topic 。

* 物理上不同 Topic 的消息分开存储。
* 逻辑上一个 Topic 的消息虽然保存于一个或多个 Broker 上，但用户只需指定消息的 Topic 即可生产或消费数据而不必关心数据存于何处。

Topic 是由使用方创建的，一般会有多个订阅者去消费对应主题的消息，也可以存在多个生产者往主题中写入消息。

### 2.3 Partition

Topic 物理上的分组，一个 Topic 可以分为多个 Partition，每个 Partition 是一个有序的队列。

Partition 中的每条消息都会被分配一个有序的 id（偏移量 offset）。

### 2.4 Producer 和 Consumer

Producer 是消息和数据的生产者，可以理解为往 Kafka **发消息的客户端**。

Consumer 是消息和数据的消费者，可以理解为从 Kafka **取消息的客户端**。

### 2.5 Consumer Group

每个 Consumer 属于一个特定的 Consumer Group（可为每个 Consumer 指定 Group Name，若不指定 Group Name 则属于默认的 Group）。 

这是 Kafka 用来实现一个 Topic 消息的广播（发给所有的 Consumer ）和单播（发给任意一个 Consumer ）的手段。一个 Topic 可以有多个 Consumer Group，Topic 的消息会复制（不是真的复制，是概念上的）到所有的 Consumer Group，但每个 Consumer Group 只会把消息发给该 Consumer Group 中的一个 Consumer。

如果要实现广播，只要每个 Consumer 有一个独立的 Consumer Group 就可以了；如果要实现单播只要所有的 Consumer 在同一个 Consumer Group。

用 Consumer Group 还可以将 Consumer 进行自由的分组而不需要多次发送消息到不同的 Topic 。

## 3. Kafka 安装

在 Linux 系统下，只需要下载官网的压缩包，`tar -zxvf`，然后配置一下环境变量即可。

Kafka 依赖 Zookeeper，但是不必担心，Kafka 的压缩包内置了 Zookeeper。

